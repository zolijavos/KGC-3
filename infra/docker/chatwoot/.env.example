# ==============================================================================
# Chatwoot Environment Configuration
# KGC ERP Integration - Story 33-2
# ==============================================================================
# Copy this file to .env and update values before running docker compose
# ==============================================================================

# ==============================================================================
# REQUIRED - Must be set before starting
# ==============================================================================

# Application Secret (REQUIRED)
# Generate with: openssl rand -base64 32
# This is used for encrypting cookies and signed URLs
SECRET_KEY_BASE=replace_with_a_long_random_key

# ==============================================================================
# Chatwoot Version
# ==============================================================================

# Chatwoot image version (CE = Community Edition)
CHATWOOT_VERSION=latest-ce

# ==============================================================================
# Server Configuration
# ==============================================================================

# Chatwoot Server Port (default: 3002)
# Note: Chatwoot internally uses 3000, mapped to 3002 to avoid conflicts
CHATWOOT_PORT=3002

# Public URL of your Chatwoot installation
FRONTEND_URL=http://localhost:3002

# Default locale for new accounts (e.g., hu, en)
DEFAULT_LOCALE=hu

# Force SSL (set to true in production)
FORCE_SSL=false

# Enable/disable new account signups: true, false, or api_only
ENABLE_ACCOUNT_SIGNUP=true

# ==============================================================================
# Database Configuration (PostgreSQL with pgvector)
# ==============================================================================

# PostgreSQL Version (must support pgvector)
POSTGRES_VERSION=pg16

# PostgreSQL Port (default: 5435 to avoid conflict with other DBs)
CHATWOOT_DB_PORT=5435

# PostgreSQL Credentials
POSTGRES_HOST=chatwoot-db
POSTGRES_USER=chatwoot
POSTGRES_PASSWORD=chatwoot
POSTGRES_DB=chatwoot_production

# Database connection timeout
POSTGRES_STATEMENT_TIMEOUT=60s

# ==============================================================================
# Redis Configuration
# ==============================================================================

# Redis Version
REDIS_VERSION=7-alpine

# Redis Port (default: 6381 to avoid conflict with KGC/Twenty Redis)
CHATWOOT_REDIS_PORT=6381

# Redis Password
REDIS_PASSWORD=chatwoot_redis_pass

# Redis URL (automatically constructed from above settings)
REDIS_URL=redis://:chatwoot_redis_pass@chatwoot-redis:6379

# ==============================================================================
# Email Configuration (Optional - Required for notifications)
# ==============================================================================

# Sender email address for outgoing emails
# MAILER_SENDER_EMAIL=Chatwoot <noreply@example.com>

# SMTP Configuration
# SMTP_DOMAIN=example.com
# SMTP_ADDRESS=smtp.example.com
# SMTP_PORT=587
# SMTP_USERNAME=
# SMTP_PASSWORD=
# SMTP_AUTHENTICATION=plain
# SMTP_ENABLE_STARTTLS_AUTO=true

# Inbound email domain (for reply-by-email feature)
# MAILER_INBOUND_EMAIL_DOMAIN=reply.example.com
# RAILS_INBOUND_EMAIL_SERVICE=relay
# RAILS_INBOUND_EMAIL_PASSWORD=

# ==============================================================================
# Storage Configuration
# ==============================================================================

# Storage type: local or s3
ACTIVE_STORAGE_SERVICE=local

# S3 Configuration (if ACTIVE_STORAGE_SERVICE=s3)
# S3_BUCKET_NAME=
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=eu-central-1

# ==============================================================================
# Logging & Debugging
# ==============================================================================

# Rails environment
RAILS_ENV=production

# Log to stdout (for Docker)
RAILS_LOG_TO_STDOUT=true

# Log level: debug, info, warn, error, fatal
LOG_LEVEL=info

# Enable lograge (structured logging)
LOGRAGE_ENABLED=true

# ==============================================================================
# Security & Rate Limiting
# ==============================================================================

# Enable request throttling (recommended for production)
ENABLE_RACK_ATTACK=true

# Request limit per period
RACK_ATTACK_LIMIT=300

# ==============================================================================
# Background Jobs (Sidekiq)
# ==============================================================================

# Number of concurrent Sidekiq workers
SIDEKIQ_CONCURRENCY=10

# ==============================================================================
# Push Notifications (Optional)
# ==============================================================================

# VAPID keys for web push notifications
# Generate with: bundle exec rails runner "puts Webpush.generate_key.inspect"
# VAPID_PUBLIC_KEY=
# VAPID_PRIVATE_KEY=

# Firebase Cloud Messaging (for mobile apps)
# FCM_SERVER_KEY=

# ==============================================================================
# Social Media Integrations (Optional)
# ==============================================================================

# Facebook
# FB_VERIFY_TOKEN=
# FB_APP_SECRET=
# FB_APP_ID=

# Instagram
# IG_VERIFY_TOKEN=

# Twitter
# TWITTER_APP_ID=
# TWITTER_CONSUMER_KEY=
# TWITTER_CONSUMER_SECRET=
# TWITTER_ENVIRONMENT=

# ==============================================================================
# OAuth / SSO (Optional)
# ==============================================================================

# Google OAuth
# GOOGLE_OAUTH_CLIENT_ID=
# GOOGLE_OAUTH_CLIENT_SECRET=
# GOOGLE_OAUTH_CALLBACK_URL=${FRONTEND_URL}/omniauth/google_oauth2/callback

# Azure Active Directory
# AZURE_APP_ID=
# AZURE_APP_SECRET=

# ==============================================================================
# AI Features (Optional)
# ==============================================================================

# OpenAI API Key (for AI-powered features)
# OPENAI_API_KEY=

# ==============================================================================
# Monitoring & APM (Optional)
# ==============================================================================

# Sentry Error Tracking
# SENTRY_DSN=

# Elastic APM
# ELASTIC_APM_SERVER_URL=
# ELASTIC_APM_SECRET_TOKEN=

# ==============================================================================
# KGC Integration (Placeholder - for future integration)
# ==============================================================================

# KGC API URL (internal Docker network or host)
# KGC_API_URL=http://host.docker.internal:3000

# Webhook secret for KGC integration
# Use: openssl rand -base64 32
# KGC_WEBHOOK_SECRET=

# API Key for KGC to access Chatwoot API
# Generate in Chatwoot UI: Settings > Integrations > API
# CHATWOOT_API_KEY=

# ==============================================================================
# Slack Integration (Optional)
# ==============================================================================

# SLACK_CLIENT_ID=
# SLACK_CLIENT_SECRET=
